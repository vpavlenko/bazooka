import re


# https://regex101.com/r/vC86NV/1
PATTERN = r'^([^ ]+) ([^ ]+) \[([^]]+)] /(.+)/'

d = {}
for line in open('cedict_ts.u8').readlines():
    traditional, simplified, pronunciation, translation = re.match(PATTERN, line).groups()
    # print(translation)
    if simplified not in d and not translation.startswith('surname'):
        d[simplified] = translation


def trim_translation(word):
    word = word.split('/')[0]
    if word.startswith('to '):
        word = word[3:]
    # remove comments in (braces)
    word = re.sub('\([^)]+\)', '', word).strip()
    return word.replace(' ', '_')


most_common_word = [('的', 47672), ('了', 17228), ('是', 14067), ('我', 12167), ('不', 10836), ('他', 10782), ('你', 10669), ('在', 10591), ('哈利', 7771), ('一', 7441), ('她', 5668), ('会', 5667), ('说', 5363), ('这', 5023), ('就', 4761), ('有', 4233), ('着', 3967), ('一个', 3935), ('教授', 3633), ('和', 3252), ('都', 3207), ('地', 3083), ('他们', 3067), ('人', 3009), ('没有', 2986), ('什么', 2726), ('到', 2719), ('能', 2654), ('也', 2562), ('上', 2551), ('想', 2528), ('如果', 2458), ('对', 2357), ('而', 2331), ('说道', 2299), ('这个', 2268), ('知道', 2207), ('把', 2202), ('让', 2178), ('自己', 2167), ('看', 2147), ('过', 2143), ('很', 2125), ('要', 2104), ('里', 2030), ('只', 2009), ('那', 1965), ('个', 1964), ('还', 1898), ('被', 1863), ('奇', 1850), ('做', 1823), ('我们', 1796), ('洛', 1781), ('话', 1713), ('然后', 1709), ('但是', 1700), ('声音', 1653), ('从', 1630), ('时候', 1619), ('用', 1601), ('事', 1593), ('但', 1588), ('来', 1504), ('可以', 1445), ('去', 1432), ('因为', 1408), ('中', 1367), ('起来', 1366), ('可能', 1361), ('下', 1344), ('吗', 1344), ('得', 1333), ('它', 1332), ('像', 1323), ('出', 1319), ('多', 1319), ('没', 1277), ('拉', 1277), ('已经', 1261), ('好', 1216), ('赫敏', 1215), ('现在', 1214), ('魔法', 1193), ('利多', 1126), ('巫师', 1103), ('点', 1086), ('向', 1086), ('先生', 1079), ('更', 1058), ('又', 1046), ('开始', 1045), ('布', 1042), ('邓', 1038), ('真正', 471), ('世界', 468), ('带', 462), ('拿', 462), ('摄', 462), ('呢', 455), ('不过', 446), ('手', 443), ('文', 441), ('麦格', 439), ('魔', 429), ('克劳', 429), ('三', 428), ('确实', 427), ('相信', 426), ('口', 425), ('希望', 425), ('仍然', 423), ('张', 421), ('啊', 419), ('最后', 416), ('后', 413), ('部分', 411), ('意识', 407), ('http', 407), ('魂', 405), ('罗', 404), ('一直', 402), ('与', 401), ('看到', 395), ('再次', 395), ('第一', 394), ('真的', 394), ('坐', 393), ('下来', 390), ('另', 390), ('好像', 389), ('表情', 388), ('变形', 386), ('这里', 384), ('马尔福', 381), ('门', 380), ('能够', 376), ('上去', 375), ('情况', 372), ('年', 371), ('眼', 370), ('看见', 370), ('战斗', 369), ('条', 368), ('明白', 368), ('变', 367), ('咒语', 367), ('见', 366), ('理解', 364), ('以后', 362), ('施展', 362), ('谁', 360), ('变成', 355), ('放', 353), ('该', 352), ('可', 351), ('大脑', 351), ('分', 350), ('笑', 350), ('之', 350), ('书', 348), ('成', 348), ('请', 345), ('几乎', 344), ('老', 344), ('进', 342), ('为了', 342), ('掉', 341), ('天', 340), ('声', 340), ('当然', 337), ('力量', 337), ('有人', 334), ('前', 334), ('等', 331), ('离开', 331), ('感到', 329), ('格', 328), ('它们', 328), ('即使', 327), ('不要', 326), ('那样', 325), ('继续', 325), ('%', 325), ('说话', 322), ('脸上', 322), ('计划', 322), ('男', 321), ('成为', 319), ('试图', 319), ('解释', 318), ('那里', 318), ('可是', 317), ('身', 316), ('出现', 315), ('正在', 315), ('令', 309), ('整个', 309), ('些', 309), ('《', 307), ('连', 306), ('气', 305), ('脸', 304), ('正', 304), ('跟', 304), ('无论', 304), ('男人', 303), ('朋友', 303), ('转', 301), ('句', 299), ('傲', 298), ('可怕', 296), ('西', 296), ('贝拉', 296), ('一边', 295), ('回', 294), ('名', 294), ('孩', 293), ('存在', 292), ('死亡', 292), ('小姐', 292), ('选择', 291), ('一会儿', 289), ('虽然', 288), ('卡', 287), ('父亲', 286), ('决定', 286), ('女巫', 285), ('找', 284), ('至少', 282), ('还是', 280), ('班', 279), ('想象', 278), ('一阵', 278), ('女孩', 278), ('只是', 276), ('房间', 276), ('阿兹', 276), ('来说', 275), ('甚至', 275), ('步', 275), ('一点', 274), ('想到', 272), ('奇怪', 271), ('学院', 269), ('思考', 268), ('住', 267), ('强大', 265), ('1', 264), ('停', 264), ('一定', 263), ('难', 263), ('算', 263), ('于', 263), ('娃', 263), ('尖叫', 262), ('同时', 262), ('黑暗', 262), ('如何', 262), ('以为', 260), ('米勒', 260), ('加', 258), ('曾经', 257), ('此', 256), ('哦', 255), ('方式', 254), ('盯', 251), ('发出', 250), ('永远', 249), ('随后', 249), ('2', 248), ('重要', 247), ('写', 246), ('确定', 245), ('想法', 244), ('记忆', 244), ('很多', 240), ('方法', 240), ('秘密', 240), ('如此', 240), ('使用', 239), ('身上', 236), ('那种', 235), ('叫', 233), ('快', 233), ('根本', 233), ('走廊', 233), ('吃', 231), ('纳威', 231), ('家族', 230), ('位', 229), ('身体', 228), ('同样', 227), ('作为', 227), ('今天', 227), ('法术', 227), ('预言', 227), ('大家', 226), ('意思', 226), ('敌人', 226), ('袍子', 225), ('·', 225), ('找到', 225), ('回答', 223), ('注意', 223), ('帕奇', 223), ('//', 222), ('试', 221), ('赫敏·格兰杰', 221), ('阳光', 221), ('关于', 220), ('wikipedia', 219), ('凤凰', 219), ('办法', 218), ('之间', 218), ('麦', 217), ('巨大', 217), ('努力', 217), ('穿', 216), ('本', 216), ('别人', 216), ('扫帚', 216), ('将军', 215), ('开', 214), ('意味着', 214), ('斯内普', 212), ('过去', 211), ('父母', 210), ('高', 210), ('拥有', 210), ('明显', 209), ('身边', 209), ('其中', 209), ('特', 209), ('面前', 208), ('原因', 207), ('问道', 207), ('有些', 207), ('四', 207), ('接受', 207), ('场', 206), ('混沌', 206), ('足够', 205), ('药', 205), ('人们', 205), ('实验', 204), ('准备', 204), ('爸爸', 203), ('保护', 203), ('危险', 202), ('从来', 202), ('其他人', 199), ('杀', 199), ('停顿', 199), ('守护神', 198), ('某种', 197), ('神秘', 197), ('卢', 197), ('光', 197), ('年级', 197), ('肯定', 195), ('以及', 195), ('打', 194), ('到底', 194), ('一起', 193), ('故事', 193), ('英雄', 193), ('格兰芬', 193), ('害怕', 192), ('名字', 192), ('考虑', 192), ('实际上', 192), ('嗯', 192), ('却', 192), ('石头', 192), ('正确', 192), ('做到', 191), ('记得', 190), ('错', 190), ('身后', 190), ('原本', 190), ('花', 189), ('食', 189), ('德拉科·马尔福', 189), ('邪恶', 189), ('勒', 189), ('是的', 188), ('够', 188), ('帮助', 188), ('得到', 188), ('直接', 188), ('莱', 188), ('思', 187), ('错误', 187), ('通过', 187), ('瞪', 186), ('回来', 186), ('小时', 186), ('徒', 186), ('魔咒', 186), ('阿', 186), ('答案', 185), ('不同', 185), ('活', 185), ('恐惧', 184), ('五', 184), ('方向', 184), ('对于', 183), ('别', 181), ('抬', 181), ('学', 181), ('生命', 181), ('岁', 179), ('安全', 179),]

non_unicode = [ ('改变', 178), ('倒', 178), ('做出', 178), ('失去', 178), ('打开', 178), ('是否', 178), ('桌子', 177), ('直到', 177), ('衣', 177), ('科学', 176), ('3', 176), ('只要', 175), ('除了', 175), ('成功', 175), ('结果', 174), ('怀疑', 174), ('回到', 174), ('长', 174), ('慢慢', 174), ('蕾', 174), ('微笑', 172), ('人类', 172), ('于是', 172), ('担心', 171), ('指', 170), ('机会', 170), ('特里克斯', 170), ('士兵', 170), ('每个', 169), ('"', 169), ('过来', 169), ('完', 169), ('伤害', 169), ('办公室', 169), ('-----------------------------------------------------------------', 169), ('她们', 168), ('喊', 167), ('片', 166), ('椅子', 166), ('第二', 165), ('哪里', 165), ('新', 165), ('面对', 165), ('无论如何', 165), ('赫奇', 165), ('西弗', 165), ('块', 164), ('消失', 164), ('每', 163), ('刚刚', 163), ('读', 163), ('清楚', 163), ('简单', 163), ('尽管', 163), ('上面', 162), ('聪明', 162), ('听说', 162), ('结束', 162), ('恐怕', 161), ('地上', 161), ('任何人', 161), ('敏', 161), ('理由', 160), ('学习', 160), ('控制', 160), ('意义', 160), ('苏珊', 160), ('达', 159), ('里面', 159), ('呃', 158), ('要求', 157), ('或', 157), ('抱歉', 157), ('或是', 157), ('喜欢', 156), ('听到', 155), ('手里', 155), ('语气', 154), ('唯一', 154), ('听见', 154), ('下去', 154), ('石', 154), ('特别', 153), ('失败', 152), ('规则', 152), ('某个', 152), ('终于', 152), ('教室', 152), ('愚蠢', 151), ('建议', 151), ('强', 150), ('手指', 150), ('没错', 150), ('分院', 150), ('家', 149), ('吸', 149), ('多少', 149), ('年老', 149), ('芙妮', 149), ('羊皮纸', 148), ('愿意', 148), ('沉默', 148), ('马上', 148), ('由', 148), ('走向', 148), ('刚才', 147), ('级', 147), ('痛苦', 147), ('段', 147), ('课', 146), ('恶霸', 146), ('面', 145), ('笑容', 145), ('转身', 145), ('战争', 145), ('比如', 144), ('看看', 144), ('半', 144), ('事实', 144), ('飞', 144), ('测试', 143), ('露出', 143), ('远', 143), ('先', 142), ('绿色', 142), ('相当', 142), ('古老', 142), ('双', 142), ('仿佛', 142), ('另外', 141), ('毕', 141), ('黑色', 140), ('忽然', 140), ('游戏', 140), ('火焰', 140), ('研究', 140), ('这时', 140), ('秒', 140), ('保持', 140), ('愤怒', 140), ('生活', 140), ('行动', 139), ('穆迪', 139), ('然而', 138), ('留', 138), ('普通', 137), ('帽子', 137), ('拒绝', 137), ('敢', 137), ('跑', 137), ('词', 136), ('目前', 136), ('全部', 136), ('攻击', 136), ('所有人', 136), ('这次', 136), ('离', 136), ('样子', 135), ('并且', 135), ('威胁', 135), ('剩下', 135), ('阻止', 135), ('行', 134), ('分钟', 134), ('光芒', 134), ('巨', 134), ('飞龙', 134), ('丝', 133), ('重新', 133), ('容易', 133), ('只能', 133), ('动作', 133), ('转换器', 133), ('学校', 132), ('魔力', 132), ('隐形', 132), ('曾', 132), ('警告', 131), ('其', 131), ('命令', 131), ('消失了', 130), ('忘', 130), ('目光', 130), ('英国', 130), ('毫无', 130), ('下面', 130), ('镜子', 130), ('妈妈', 129), ('疯', 129), ('立刻', 129), ('完成', 129), ('周围', 129), ('位置', 129), ('而已', 128), ('进行', 128), ('其实', 128), ('能力', 128), ('主人', 128), ('承认', 127), ('解决', 127), ('保证', 127), ('福克斯', 127), ('只有', 126), ('点点', 126), ('杀死', 126), ('绝对', 126), ('除非', 126), ('别的', 126), ('干', 125), ('4', 125), ('金属', 125), ('传来', 125), ('遍', 125), ('阿不思·邓布', 125), ('教', 124), ('军队', 124), ('守护神咒', 124), ('有的', 123), ('同意', 123), ('送', 123), ('心里', 122), ('提', 122), ('仅仅', 122), ('不再', 122), ('方面', 122), ('猜', 122), ('安静', 122), ('明亮', 122), ('真相', 122), ('其它', 122), ('银色', 121), ('NEWCHAPTER', 121), ('年轻', 121), ('六', 120), ('十', 120), ('震惊', 120), ('越来越', 120), ('org/wiki/', 120), ('隐身', 120), ('根', 119), ('基因', 119), ('神', 119), ('爱', 118), ('女人', 118), ('红色', 118), ('哪怕', 117), ('来自', 117), ('灵魂', 117), ('显然', 117), ('梅林', 117), ('//en', 117), ('生物', 117), ('因此', 117), ('最终', 116), ('怎样', 116), ('接着', 116), ('更加', 116), ('突然', 116), ('糟糕', 115), ('叹', 115), ('尝试', 115), ('好吧', 114), ('搞', 113), ('七', 113), ('惊讶', 113), ('严肃', 113), ('行为', 113), ('仪式', 113), ('月', 112), ('靠', 112), ('现实', 112), ('指向', 112), ('呼吸', 112), ('威', 112), ('影响', 112), ('阁下', 112), ('进入', 111), ('犹豫', 111), ('工作', 111), ('一般', 110), ('充满', 110), ('利用', 110), ('金色', 110), ('奇洛', 110), ('允许', 109), ('目标', 109), ('紧张', 109), ('举起', 109), ('盾', 108), ('完美', 107), ('向前', 107), ('斯莱特', 107), ('颤抖', 107), ('zh', 107), ('谈话', 106), ('谢谢', 106), ('可能性', 106), ('状态', 106), ('念', 106), ('baike', 106), ('baidu', 106), ('往', 106), ('依然', 106), ('弗立维', 106), ('药学', 106), ('钱', 105), ('懂', 105), ('多么', 105), ('内心', 105), ('空气', 105), ('真实', 104), (',', 104), ('眼神', 104), ('低', 104), ('动', 104), ('造成', 104), ('程度', 103), ('转向', 103), ('不知', 103), ('地板', 103), ('母亲', 103), ('帮', 102), ('证据', 102), ('脑子', 102), ('证明', 102), ('冰冷', 102), ('假设', 102), ('打败', 102), ('事实上', 102), ('决斗', 102), ('本身', 102), ('黑暗面', 102), ('宇宙', 101), ('如', 101), ('获得', 101), ('大声', 101), ('实在', 101), ('平静', 101), ('少', 101), ('信息', 101), ('隆', 101), ('后面', 100), ('发抖', 100), ('一部分', 100), ('修斯', 100), ('小心', 100), ('卢修斯·马尔福', 100), ('某些', 100), ('帕德玛', 100), ('表现', 99), ('公平', 99), ('小小的', 99), ('犯', 99), ('理论', 98), ('间', 98), ('有点', 98), ('当时', 98), ('跟着', 98), ('边', 98), ('生', 97), ('速度', 97), ('心', 97), ('麻烦', 97), ('回去', 97), ('队', 97), ('移动', 97), ('大概', 96), ('落', 96), ('国家', 96), ('缓缓', 96), ('假装', 96), ('穿过', 96), ('久', 96), ('历史', 95), ('受到', 95), ('记住', 95), ('总是', 95), ('信', 94), ('没什么', 94), ('答道', 94), ('视线', 94), ('科学家', 94), ('无', 94), ('比较', 94), ('取', 94), ('各种', 94), ('了解', 94), ('空', 94), ('低语', 94), ('战士', 94), ('本人', 94), ('汉娜', 94), ('内', 94), ('阿米莉亚', 94), ('总', 93), ('理性', 93), ('墙', 93), ('躺', 93), ('htm', 93), ('乔治', 93), ('E5%', 93), ('军团', 93), ('假说', 92), ('复杂', 92), ('冲', 92), ('楼梯', 92), ('同', 92), ('蓝色', 92), ('肩膀', 91), ('握', 91), ('认识', 91), ('放弃', 91), ('抓住', 91), ('救', 91), ('水', 91), ('死去', 91), ('按', 90), ('把手', 90), ('智慧', 90), ('进去', 90), ('--------------------------------------------------------------------------', 90), ('属于', 90), ('太阳', 90), ('信任', 90), ('魁地奇', 90), ('自我', 90), ('星星', 90), ('条件', 89), ('学会', 89), ('无辜', 89), ('5', 89), ('有趣', 89), ('赢', 88), ('不行', 88), ('未来', 88), ('寻找', 88), ('代价', 88), ('跳', 88), ('帽', 88), ('嘴唇', 87), ('哭', 87), ('已', 87), ('知', 87), ('应', 87), ('紧', 87), ('严厉', 87), ('制造', 87), ('部', 87), ('十分', 87), ('呆', 86), ('眨', 86), ('撞', 86), ('看来', 86), ('以前', 86), ('讨论', 86), ('独角兽', 86), ('语', 86), ('恐怖', 85), ('留下', 85), ('绝望', 85), ('显得', 85), ('买', 84), ('您', 84), ('因', 84), ('比赛', 84), ('深', 83), ('不用', 83), ('本来', 83), ('换', 83), ('反应', 83), ('嘴', 83), ('头脑', 83), ('正常', 83), ('之一', 83), ('难道', 83), ('旁边', 83), ('戈', 83), ('背后', 83), ('疯狂', 83), ('悲伤', 83), ('俩', 83), ('中间', 83), ('夫人', 82), ('认真', 82), ('老师', 82), ('副', 82), ('糟', 82), ('摇头', 82), ('空中', 82), ('出去', 82), ('根据', 82), ('当中', 82), ('冷酷', 82), ('双胞胎', 82), ('钥匙', 82), ('指出', 81), ('不对', 81), ('儿子', 81), ('角色', 81), ('角度', 81), ('哈', 81), ('外', 81), ('弗雷德', 81), ('之中', 81), ('战', 81), ('纸', 80), ('处', 80), ('头发', 80), ('喉咙', 80), ('哪', 80), ('猜测', 80), ('出身', 80), ('故意', 80), ('西弗勒斯·斯内普', 80), ('接近', 80), ('韦斯', 80), ('字条', 80), ('伤疤', 79), ('白色', 79), ('维持', 79), ('阴谋', 79), ('路', 79), ('绝不', 79), ('标记', 79), ('越', 79), ('支', 79), ('则', 79), ('大师', 79), ('阴影', 79), ('概率', 78), ('墙上', 78), ('合理', 78), ('互相', 78), ('长长的', 78), ('受', 78), ('值得', 78), ('女', 78), ('开口', 77), ('出于', 77), ('消息', 77), ('不然', 77), ('恢复', 77), ('球', 77), ('斗篷', 77), ('誓言', 77), ('达芙妮', 77), ('层', 76), ('小声', 76), ('喝', 76), ('微微', 76), ('好奇', 76), ('系统', 76), ('长大', 76), ('摩', 76), ('望', 76), ('检查', 76), ('使', 76), ('扭曲', 76), ('悄声', 76), ('假', 75), ('群', 75), ('经过', 75), ('金', 75), ('非', 75), ('道德', 75), ('知识', 75), ('效果', 75), ('毁灭', 75), ('或许', 75), ('复活', 75), ('观察', 74), ('牺牲', 74), ('背叛', 74), ('迅速', 74), ('回头', 74), ('十一', 74), ('坏', 74), ('6', 74), ('胜利', 74), ('血', 74), ('目的', 74), ('份', 74), ('高尔', 74), ('魂器', 74), ('倒下', 73), ('堆', 73), ('提高', 73), ('坚持', 73), ('精神', 73), ('忘记', 73), ('弄', 73), ('产生', 73), ('森林', 73), ('轻柔', 73), ('第三', 72), ('扇', 72), ('天空', 72), ('困惑', 72), ('早', 72), ('火', 72), ('走开', 72), ('描述', 72), ('带来', 72), ('冷静', 72), ('E6%', 72), ('大厅', 72), ('双手', 71), ('那时', 71), ('燃烧', 71), ('般', 71), ('集中', 71), ('不错', 71), ('口袋', 71), ('之外', 71), ('差点', 71), ('晚上', 71), ('脑海', 71), ('拯救', 71), ('施放', 71), ('军', 71), ('感', 70), ('发', 70), ('发明', 70), ('尽可能', 70), ('笑声', 70), ('处理', 70), ('对的', 70), ('封闭', 70), ('近', 70), ('方', 70), ('起身', 70), ('低头', 69), ('扔', 69), ('受伤', 69), ('静静', 69), ('敲', 69), ('内容', 69), ('灰色', 69), ('永生', 69), ('停止', 69), ('任务', 69), ('距离', 69), ('白痴', 69), ('扎比尼', 69), ('感受', 68), ('重复', 68), ('之类', 68), ('表示', 68), ('包括', 68), ('进来', 68)]

# for word, count in most_common_word:
#     if word in d:
#         print(word, trim_translation(d[word]))
#     else:
#         print(word, "NO TRANSLATION")

def E(word):
    '''
    Does the translation exist?
    '''
    return word in d


def get_translation(word, debug=True):
    def T(word):
        if debug:
            return f'{word} {trim_translation(d[word])}  '
        else:
            translation = f'{trim_translation(d[word])}'
            if len(translation) == 0:
                print(f'WORD WITH ZERO-LENGTH TRANSLATION: {word} {d[word]}')
            return translation

    if E(word):
        translation = T(word)
    elif E(word[:1]) and E(word[1:]):
        translation = f'{T(word[:1])} {T(word[1:])}'
    elif E(word[:2]) and E(word[2:]):
        translation = f'{T(word[:2])} {T(word[2:])}'
    else:
        translation = f'*{word}'
    return translation
